#! /bin/sh
uu1 <-read.table("RPRQQ1.Rqq",colClasses=c("numeric","numeric","numeric","numeric","character","numeric"), h=F)
attach(uu1)
names(uu1) <- c("lng", "CHR", "lgp", "P", "SNP", "BP")
head(uu1)
par(bg="white")
png(filename="REPFILE.png", width = 1800, height = 600, pointsize = 16, bg ="white", res=NA, type="cairo")
prb <- uu1$P[which(!is.na(uu1$P))]
N <-length(prb)
expchi <- qchisq(p = (1:N)/(N + 1), df = 1)
obschi <- sort(qchisq(prb,df=1, lower.tail=FALSE))
trim <- 0.5
Nu <- floor(trim * N)
lambda1 <- mean(obschi[1:Nu])/mean(expchi[1:Nu])
lambda2 <- median(obschi/0.455)
obs <- -log10(sort(prb,decreasing=F))
exp <- -log10((1:N)/N)
k <- c(1:N)
alpha <- 0.05
lower <- qbeta(alpha/2,k,N+1-k)
upper <- qbeta((1-alpha/2),k,N+1-k)
shade <- function(x1, y1, x2, y2, color = col.shade) {
polygon(c(x1, x2[N:1]), c(y1, y2[N:1]), border = NA, col = color)
}
summary(prb)
summary(obs)
par(mfrow=c(1,3))
par(mar=c(5,5,5,1),mgp=c(2.3,.6,0))
plot(exp,obs,main="REPNAME1 (REPPROG1)",xlab=expression(Expected~~-log[10](italic(p))),
     ylab=expression(Observed~~-log[10](italic(p))), cex.lab=1.6, xlim=c(0,max(obs)+2), ylim=c(0,max(obs)+2),cex.main=2.1)
shade(exp,-log10(lower),exp,-log10(upper), color = "grey")
points(exp,obs,pch=21,cex=1.2)
mxx3 <- head(exp, n=3)
mxy3 <- head(obs, n=3)
head(mxx3)
head(mxy3)
text(mxy3[1]/2+1,mxy3[1]/3.5,expression(lambda), pos=4, cex=1.8, col="black")
text(mxy3[1]/1.9+1,mxy3[1]/3.5,paste(" = ", format(lambda2, digits = 4), sep=""), pos=4, cex=1.8, col="black")
text(mxy3[1]/2+1,mxy3[1]/4.8,paste("SNP N = ", N, sep=""), pos=4, cex=1.8, col="black")
abline(0,1,col="red")
uu2 <-read.table("RPRQQ2.Rqq",colClasses=c("numeric","numeric","numeric","numeric","character","numeric"), h=F)
attach(uu2)
names(uu2) <- c("lng", "CHR", "lgp", "P", "SNP", "BP")
head(uu2)
prb <- uu2$P[which(!is.na(uu2$P))]
N <-length(prb)
expchi <- qchisq(p = (1:N)/(N + 1), df = 1)
obschi <- sort(qchisq(prb,df=1, lower.tail=FALSE))
trim <- 0.5
Nu <- floor(trim * N)
lambda1 <- mean(obschi[1:Nu])/mean(expchi[1:Nu])
lambda2 <- median(obschi/0.455)
obs <- -log10(sort(prb,decreasing=F))
exp <- -log10((1:N)/N)
k <- c(1:N)
alpha <- 0.05
lower <- qbeta(alpha/2,k,N+1-k)
upper <- qbeta((1-alpha/2),k,N+1-k)
shade <- function(x1, y1, x2, y2, color = col.shade) {
polygon(c(x1, x2[N:1]), c(y1, y2[N:1]), border = NA, col = color)
}
summary(prb)
summary(obs)
plot(exp,obs,main="REPNAME2 (REPPROG2)",xlab=expression(Expected~~-log[10](italic(p))),
     ylab=expression(Observed~~-log[10](italic(p))), cex.lab=1.6, xlim=c(0,max(obs)+2), ylim=c(0,max(obs)+2),cex.main=2.1)
shade(exp,-log10(lower),exp,-log10(upper), color = "grey")
points(exp,obs,pch=21,cex=0.8)
mxx3 <- head(exp, n=3)
mxy3 <- head(obs, n=3)
head(mxx3)
head(mxy3)
text(mxy3[1]/2+1,mxy3[1]/3.5,expression(lambda), pos=4, cex=1.8, col="black")
text(mxy3[1]/1.9+1,mxy3[1]/3.5,paste(" = ", format(lambda2, digits = 4), sep=""), pos=4, cex=1.8, col="black")
text(mxy3[1]/2+1,mxy3[1]/4.8,paste("SNP N = ", N, sep=""), pos=4, cex=1.8, col="black")
abline(0,1,col="red")
uu3 <-read.table("RPRQQ3.Rqq",colClasses=c("numeric","numeric","numeric","numeric","character","numeric"), h=F)
attach(uu3)
names(uu3) <- c("lng", "CHR", "lgp", "P", "SNP", "BP")
head(uu3)
prb <- uu3$P[which(!is.na(uu3$P))]
N <-length(prb)
expchi <- qchisq(p = (1:N)/(N + 1), df = 1)
obschi <- sort(qchisq(prb,df=1, lower.tail=FALSE))
trim <- 0.5
Nu <- floor(trim * N)
lambda1 <- mean(obschi[1:Nu])/mean(expchi[1:Nu])
lambda2 <- median(obschi/0.455)
obs <- -log10(sort(prb,decreasing=F))
exp <- -log10((1:N)/N)
k <- c(1:N)
alpha <- 0.05
lower <- qbeta(alpha/2,k,N+1-k)
upper <- qbeta((1-alpha/2),k,N+1-k)
shade <- function(x1, y1, x2, y2, color = col.shade) {
polygon(c(x1, x2[N:1]), c(y1, y2[N:1]), border = NA, col = color)
}
summary(prb)
summary(obs)
plot(exp,obs,main="REPNAME3 (REPPROG3)",xlab=expression(Expected~~-log[10](italic(p))),
     ylab=expression(Observed~~-log[10](italic(p))), cex.lab=1.6, xlim=c(0,max(obs)+2), ylim=c(0,max(obs)+2),cex.main=2.1)
shade(exp,-log10(lower),exp,-log10(upper), color = "grey")
points(exp,obs,pch=21,cex=0.8)
mxx3 <- head(exp, n=3)
mxy3 <- head(obs, n=3)
head(mxx3)
head(mxy3)
text(mxy3[1]/2+1,mxy3[1]/3.5,expression(lambda), pos=4, cex=1.8, col="black")
text(mxy3[1]/1.9+1,mxy3[1]/3.5,paste(" = ", format(lambda2, digits = 4), sep=""), pos=4, cex=1.8, col="black")
text(mxy3[1]/2+1,mxy3[1]/4.8,paste("SNP N = ", N, sep=""), pos=4, cex=1.8, col="black")
abline(0,1,col="red")
dev.off()

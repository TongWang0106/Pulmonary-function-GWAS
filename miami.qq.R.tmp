#! /bin/sh
uu1 <-read.table("RPRQQ1.Rqq",colClasses=c("numeric","numeric","numeric","numeric","character","numeric"), h=F)
attach(uu1)
names(uu1) <- c("lng", "CHR", "lgp", "P", "SNP", "BP")
head(uu1)
par(bg="white")
png(filename="REPFILE.png", width = 1000, height = 500, pointsize = 12, bg ="white", res=NA, type="cairo")
prb <- uu1$P[which(!is.na(uu1$P))]
N <-length(prb)
expchi <- qchisq(p = (1:N)/(N + 1), df = 1)
obschi <- sort(qchisq(prb,df=1, lower.tail=FALSE))
trim <- 0.5
Nu <- floor(trim * N)
lambda1 <- mean(obschi[1:Nu])/mean(expchi[1:Nu])
lambda2 <- median(obschi/0.455)
obs <- -log10(sort(prb,decreasing=F))
exp <- -log10((1:N)/N)
k <- c(1:N)
alpha <- 0.05
lower <- qbeta(alpha/2,k,N+1-k)
upper <- qbeta((1-alpha/2),k,N+1-k)
shade <- function(x1, y1, x2, y2, color = col.shade) {
polygon(c(x1, x2[N:1]), c(y1, y2[N:1]), border = NA, col = color)
}
summary(prb)
summary(obs)
par(mfrow=c(1,2),mgp=c(2,.5,0))
plot(exp,obs,main="REPNAME1 (REPPROG1)",xlab=expression(Expected~~-log[10](italic(p))),
     ylab=expression(Observed~~-log[10](italic(p))), xlim=c(0,max(obs)+1), ylim=c(0,max(obs)+1),cex.main=1.1)
shade(exp,-log10(lower),exp,-log10(upper), color = "grey")
points(exp,obs,pch=21,cex=0.8)
mxx3 <- head(exp, n=3)
mxy3 <- head(obs, n=3)
head(mxx3)
head(mxy3)
text(mxy3[1]/2,mxy3[1]/3.5,expression(lambda), pos=4, cex=1.2, col="black")
text(mxy3[1]/1.9,mxy3[1]/3.5,paste(" = ", format(lambda2, digits = 4), sep=""), pos=4, cex=1.2, col="black")
text(mxy3[1]/2,mxy3[1]/4.5,paste("SNP N = ", N, sep=""), pos=4, cex=1.2, col="black")
abline(0,1,col="red")
uu2 <-read.table("RPRQQ2.Rqq",colClasses=c("numeric","numeric","numeric","numeric","character","numeric"), h=F)
attach(uu2)
names(uu2) <- c("lng", "CHR", "lgp", "P", "SNP", "BP")
head(uu2)
prb <- uu2$P[which(!is.na(uu2$P))]
N <-length(prb)
expchi <- qchisq(p = (1:N)/(N + 1), df = 1)
obschi <- sort(qchisq(prb,df=1, lower.tail=FALSE))
trim <- 0.5
Nu <- floor(trim * N)
lambda1 <- mean(obschi[1:Nu])/mean(expchi[1:Nu])
lambda2 <- median(obschi/0.455)
obs1 <- -log10(sort(prb,decreasing=F))
head(obs1)
tail(obs1)
obs2 <- obs1
obs2[is.infinite(obs2)] <- 0
obs <- sort(obs2,decreasing=T)
exp <- -log10((1:N)/N)
head(obs)
tail(obs)
k <- c(1:N)
alpha <- 0.05
lower <- qbeta(alpha/2,k,N+1-k)
upper <- qbeta((1-alpha/2),k,N+1-k)
shade <- function(x1, y1, x2, y2, color = col.shade) {
polygon(c(x1, x2[N:1]), c(y1, y2[N:1]), border = NA, col = color)
}
summary(prb)
summary(obs)
plot(exp,obs,main="REPNAME2 (REPPROG2)",xlab=expression(Expected~~-log[10](italic(p))),
     ylab=expression(Observed~~-log[10](italic(p))), xlim=c(0,max(obs)+1), ylim=c(0,max(obs)+1),cex.main=1.1)
shade(exp,-log10(lower),exp,-log10(upper), color = "grey")
points(exp,obs,pch=21,cex=0.8)
mxx3 <- head(exp, n=3)
mxy3 <- head(obs, n=3)
head(mxx3)
head(mxy3)
text(mxy3[1]/2,mxy3[1]/3.5,expression(lambda), pos=4, cex=1.2, col="black")
text(mxy3[1]/1.9,mxy3[1]/3.5,paste(" = ", format(lambda2, digits = 4), sep=""), pos=4, cex=1.2, col="black")
text(mxy3[1]/2,mxy3[1]/4.5,paste("GENE N = ", N, sep=""), pos=4, cex=1.2, col="black")
abline(0,1,col="red")
dev.off()
